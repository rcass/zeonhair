/*! Backstretch - v2.0.4 - 2013-06-19
* http://srobbin.com/jquery-plugins/backstretch/
* Copyright (c) 2013 Scott Robbin; Licensed MIT */
(function(z,y,g){z.fn.backstretch=function(d,a){if(typeof a!=="undefined"){if("undefined"===typeof a.mode){if(typeof themifyScript!="undefined"&&"undefined"!=typeof themifyScript.backgroundMode){a.mode=themifyScript.backgroundMode}else{if(typeof themifyVars!="undefined"&&"undefined"!=typeof themifyVars.backgroundMode){a.mode=themifyVars.backgroundMode}}}if("undefined"===typeof a.position){if(typeof themifyScript!="undefined"&&"undefined"!=typeof themifyScript.backgroundPosition&&""!=typeof themifyScript.backgroundPosition){a.position=themifyScript.backgroundPosition}else{if(typeof themifyVars!="undefined"&&"undefined"!=typeof themifyVars.backgroundPosition&&""!=typeof themifyVars.backgroundPosition){a.position=themifyVars.backgroundPosition}}}if("undefined"===typeof a.is_first){a.is_first=true}}(d===g||0===d.length)&&z.error("No images were supplied for Backstretch");0===z(y).scrollTop()&&y.scrollTo(0,0);return this.each(function(){var f=z(this),e=f.data("backstretch");if(e){if("string"==typeof d&&"function"==typeof e[d]){e[d](a);return}a=z.extend(e.options,a);e.destroy(!0)}e=new c(this,d,a);f.data("backstretch",e)})};z.backstretch=function(d,a){return z("body").backstretch(d,a).data("backstretch")};z.expr[":"].backstretch=function(a){return z(a).data("backstretch")!==g};z.fn.backstretch.defaults={centeredX:!0,centeredY:!0,duration:5000,fade:0,mode:"",position:""};var b={left:0,top:0,overflow:"hidden",margin:0,padding:0,height:"100%",width:"100%",zIndex:-999999},B={position:"absolute",display:"none",margin:0,padding:0,border:"none",width:"auto",height:"auto",maxHeight:"none",maxWidth:"none",zIndex:-999999},c=function(f,a,d){this.options=z.extend({},z.fn.backstretch.defaults,d||{});this.images=z.isArray(a)?a:[a];z.each(this.images,function(){z("<img />")[0].src=this});this.isBody=f===document.body;this.$container=z(f);this.$root=this.isBody?o?z(y):z(document):this.$container;f=this.$container.children(".backstretch").first();this.$wrap=f.length?f:z('<div class="backstretch"></div>').css(b).appendTo(this.$container);this.isBody||(f=this.$container.css("position"),a=this.$container.css("zIndex"),this.$container.css({position:"static"===f?"relative":f,zIndex:"auto"===a?0:a,background:"none"}),this.$wrap.css({zIndex:-999998}));this.$wrap.css({position:this.isBody&&o?"fixed":"absolute"});this.index=0;this.show(this.index,this.options.is_first);z(y).on("resize.backstretch",z.proxy(this.resize,this)).on("orientationchange.backstretch",z.proxy(function(){this.isBody&&0===y.pageYOffset&&(y.scrollTo(0,1),this.resize())},this))};c.prototype={resize:function(){try{var s={left:0,top:0},r=this.isBody?this.$root.width():this.$root.innerWidth(),q=r,n=this.isBody?y.innerHeight?y.innerHeight:this.$root.height():this.$root.innerHeight(),l=q/this.$img.data("ratio"),p;if("best-fit"===this.options.mode){var d=parseFloat(this.$img.data("ratio")),k=q/n;if(k>d){this.$img.addClass("best-fit-vertical").removeClass("best-fit-horizontal")}else{this.$img.addClass("best-fit-horizontal").removeClass("best-fit-vertical")}}l>=n?(p=(l-n)/2,this.options.centeredY&&(s.top="-"+p+"px")):(l=n,q=l*this.$img.data("ratio"),p=(q-r)/2,this.options.centeredX&&(s.left="-"+p+"px"));this.$wrap.css({width:r,height:n}).find("img:not(.deleteable)").css({width:q,height:l}).css(s)}catch(m){}return this},show:function(l,f){if(!(Math.abs(l)>this.images.length-1)){var a=this,h=a.$wrap.find("img").addClass("deleteable"),k={relatedTarget:a.$container[0]};a.$container.trigger(z.Event("backstretch.before",k),[a,l]);this.index=l;clearInterval(a.interval);a.$img=z("<img />").css(B).bind("load",function(n){var e=this.width||z(n.target).width();n=this.height||z(n.target).height();z(this).data("ratio",e/n);if(typeof a!=="undefined"){if("best-fit"===a.options.mode){z(this).parent().addClass("best-fit-wrap");var d=e/n,m=a.$wrap.width()/a.$wrap.height();if(m>d){z(this).addClass("best-fit best-fit-vertical")}else{z(this).addClass("best-fit best-fit-horizontal")}}else{if("fullcover"===a.options.mode&&a.options.position){z(this).addClass("fullcover-"+a.options.position)}}if(f){z(this).show()}}z(this).fadeIn(a.options.speed||a.options.fade,function(){h.remove();a.paused||a.cycle();z(["after","show"]).each(function(){a.$container.trigger(z.Event("backstretch."+this,k),[a,l])})});a.resize()}).appendTo(a.$wrap);a.$img.attr("src",a.images[l]);return a}},next:function(){return this.show(this.index<this.images.length-1?this.index+1:0,false)},prev:function(){return this.show(0===this.index?this.images.length-1:this.index-1,false)},pause:function(){this.paused=!0;return this},resume:function(){this.paused=!1;this.next();return this},cycle:function(){1<this.images.length&&(clearInterval(this.interval),this.interval=setInterval(z.proxy(function(){this.paused||this.next()},this),this.options.duration));return this},destroy:function(a){z(y).off("resize.backstretch orientationchange.backstretch");clearInterval(this.interval);a||this.$wrap.remove();this.$container.removeData("backstretch")}};var o,w=navigator.userAgent,j=navigator.platform,x=w.match(/AppleWebKit\/([0-9]+)/),x=!!x&&x[1],v=w.match(/Fennec\/([0-9]+)/),v=!!v&&v[1],i=w.match(/Opera Mobi\/([0-9]+)/),A=!!i&&i[1],u=w.match(/MSIE ([0-9]+)/),u=!!u&&u[1];o=!((-1<j.indexOf("iPhone")||-1<j.indexOf("iPad")||-1<j.indexOf("iPod"))&&x&&534>x||y.operamini&&"[object OperaMini]"==={}.toString.call(y.operamini)||i&&7458>A||-1<w.indexOf("Android")&&x&&533>x||v&&6>v||"palmGetResource" in y&&x&&534>x||-1<w.indexOf("MeeGo")&&-1<w.indexOf("NokiaBrowser/8.5.0")||u&&6>=u)})(jQuery,window);