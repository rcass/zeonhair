/*
 Themify Builder - Asynchronous Script and Styles Loader */
var tbLoaderVars,themifyBuilder;
(function(b,f,d,m){function k(b,d,c){c||(c=f.location.href);var e=RegExp("([?|&])"+b+"=.*?(&|#|$)(.*)","gi");if(e.test(c))return void 0!==d&&null!==d?c.replace(e,"$1"+b+"="+d+"$2$3"):c.replace(e,"$1$3").replace(/(&|\?)$/,"");if(void 0!==d&&null!==d){var e=-1!==c.indexOf("?")?"&":"?",a=c.split("#");return c=a[0]+e+b+"="+d,a[1]&&(c+="#"+a[1]),c}return c}b(d).ready(function(){var g=b(".themify_builder_content:not(.not_editable_builder)"),l="undefined"!==typeof wp&&"undefined"!==typeof wp.customize,c=
b("<div/>",{id:"themify_builder_alert","class":"themify-builder-alert busy"});0<g.length&&!l&&g.after('<a class="themify_builder_turn_on js-turn-on-builder" href="#"><span class="dashicons dashicons-edit"></span>'+tbLoaderVars.turnOnBuilder+"</a>");b("#wp--wrap").remove();b("body").on("click.tbloader",".toggle_tf_builder a:first, a.js-turn-on-builder",function(e){e.preventDefault();0===b(".themify-builder-alert").length&&b("body").append(c);b(".themify_builder_front_icon").parent().append(b(tbLoaderVars.progress));
e=b.post(tbLoaderVars.ajaxurl,{action:"themify_builder_loader",scripts:tbLoaderVars.assets.scripts,styles:tbLoaderVars.assets.styles});e.fail(function(){b("#themify_builder_alert").removeClass("busy").fadeOut(800);f.console&&console.log("AJAX failed")});e.done(function(a){try{a=b.parseJSON(a)}catch(h){f.console&&console.log(a);return}if(a){var c=0,e=0;b.ajax({url:tbLoaderVars.ajaxurl,type:"POST",data:{action:"themify_builder_loader_tpl",post_id:tbLoaderVars.post_ID},success:function(c){c&&d.getElementsByTagName("body")[0].insertAdjacentHTML("beforeend",
c);a.scripts?(e=a.scripts.length-1,b(a.scripts).each(function(){var c=this.footer?"body":"head";tbLoaderVars.assets.scripts.push(this.handle);if(this.jsVars){var a=d.createElement("script"),h=d.createTextNode("//<![CDATA[ \n"+this.jsVars+"\n//]]\x3e");a.type="text/javascript";a.appendChild(h);d.getElementsByTagName(c)[0].appendChild(a)}a=d.createElement("script");a.type="text/javascript";a.src=this.src;a.id=this.handle;a.async=!1;a.onload=function(){0===e&&(themifyBuilder&&(themifyBuilder.post_ID=
tbLoaderVars.post_ID,themifyBuilder.isRevisionEnabled=tbLoaderVars.isRevisionEnabled),b("body").off("click.tbloader"),b("body").trigger("builderscriptsloaded.themify"));e--};a.onerror=function(){e--};d.getElementsByTagName(c)[0].appendChild(a)})):b("body").trigger("builderscriptsloaded.themify");c=k("tb-preview",1,f.location.href);c=c.replace("#builder_active","");b("#themify_builder_site_canvas_iframe").attr("src",c).on("load",function(){b("body").trigger("builderiframeloaded.themify")})}});a.styles&&
(c=a.styles.length-1,b(a.styles).each(function(){tbLoaderVars.assets.styles.push(this.handle);var a=d.createElement("link");a.rel="stylesheet";a.href=this.src;a.id=this.handle+"-css";a.async=!1;a.onload=function(){0===c&&b("body").trigger("builderstylesloaded.themify");c--};a.onerror=function(){c--};a&&d.getElementsByTagName("head")[0].appendChild(a)}))}})});"#builder_active"===f.location.hash&&(0<b(".toggle_tf_builder a:first").length?b(".toggle_tf_builder a:first").trigger("click"):0<b(".js-turn-on-builder").length&&
b(".js-turn-on-builder").first().trigger("click"))})})(jQuery,window,document);
