(function(e,c,a){if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}var d="themifyScrollHighlight",g={speed:parseInt(tbScrollHighlight.speed),prefix:".tb_section-",navigation:tbScrollHighlight.navigation,context:"body",element:".themify_builder_row",scrollRate:250,considerHeader:false,fixedHeaderHeight:0,scroll:"internal"};function b(i,h){this.element=i;this.options=e.extend({},g,h);this._defaults=g;if(e("#headerwrap").length>0){var j=e("#headerwrap").clone();j.removeClass("fixed-header").removeAttr("id").css({position:"absolute",left:"-10000px"}).appendTo("body");this.options.fixedHeaderHeight=j.outerHeight(true)+10;j.remove()}this.init()}function f(h){return h.replace(/#.*$/,"").replace(/\/$/,"")}b.prototype={getOffset:function(){var i=e("#wpadminbar"),h=e("#headerwrap"),j=parseInt(tbScrollHighlight.scrollOffset);if(this.options.considerHeader&&h.length>0&&e("body").hasClass("has-fixed-header")){j=h.outerHeight()}if(i.length>0){j+=i.outerHeight()}return j},highlightLink:function(i){this.dehighlightLinks();if(""!=i){var h=e(this.options.navigation).find('a[href*="'+i+'"]');if(h.length>0){h.each(function(){var j=e(this);if(j.prop("hash")===i){j.parent().addClass("current_page_item");e("body").trigger("scrollhighlight.themify",[i]);return}})}}},dehighlightLinks:function(){e(this.options.navigation).find('a[href*="#"]').each(function(){e(this).parent().removeClass("current_page_item").removeClass("current-menu-item")})},isInViewport:function(n){if("undefined"===typeof n.offset()){return false}var l=e(c),m=l.height(),k=l.scrollTop(),i=k+(m/4),j=n.offset().top,h=j+n.height();return((j<=i)&&(h>=k))},isHash:function(h){return h&&"#"!==h},removeHash:function(){var h=c.location;if(this.isCorrectHash()&&this.isHash(h.hash)){if("replaceState" in history){history.replaceState("",a.title,h.pathname+h.search)}}},changeHash:function(j){if("replaceState" in history){history.replaceState(null,null,j)}else{var k=j.replace(/^.*#/,"");if(k){var i=e(this.options.prefix+k);if(i.length>0){var h=i.attr("id");i.attr("id",h+"tmpobjxyz5783a");c.location.hash=k;i.attr("id",h)}}}},isCorrectHash:function(){var h=location.hash.slice(1);return !!(h!=""&&h.indexOf("!")===-1)},linkScroll:function(n,i){var h=this,m=n.replace(h.options.prefix,"#");n=e(n);if(n.length>1){n=n.filter(":visible").first();if(n.length===0){n=e(n).first();if(n.length===0){return}}}var o=n.offset().top-this.getOffset(),l=this.options.speed,j=e("html,body");e("body").trigger("scrollhighlightstart.themify",[m]);if("internal"===h.options.scroll){var k=function(){h.highlightLink(m);if(i!==c.location.hash){h.changeHash(i)}h.scrolling=false};j.stop().animate({scrollTop:o},{duration:l,complete:function(){if(tbScrollHighlight.fixedHeaderSelector!=""&&e(tbScrollHighlight.fixedHeaderSelector).length>0&&e(c).scrollTop()>h.options.fixedHeaderHeight){var p=e(tbScrollHighlight.fixedHeaderSelector).outerHeight(true),q=n.offset().top-h.getOffset();j.stop().animate({scrollTop:Math.ceil(q-p)},300,k)}else{k()}}})}else{h.highlightLink(m);if(i!==c.location.hash){h.changeHash(i)}h.scrolling=false}},manualScroll:function(k){if(k.length>0){if(e(c).scrollTop()<50){this.dehighlightLinks();this.removeHash()}else{var i=this,j=false,h="";e.each(k,function(l,m){if(i.isInViewport(m)){h="";if(m.data("anchor")){h="#"+m.data("anchor");j=true;if(""!=h){return}}}});if("#"!==h&&h!==c.location.hash){i.highlightLink(h);i.changeHash(h)}if(!j){i.dehighlightLinks()}}}},scrolling:false,init:function(){var h=this;e(this.options.context).find('a[href*="#"]').not('a[href="#"]').not("a.ab-item").on("click",function(m){var l=e(this).prop("hash"),k=l.replace(/#/,h.options.prefix);if(f(c.location.href)==f(e(this).prop("href"))&&e(k).length>0){h.scrolling=true;h.linkScroll(k,l);m.preventDefault()}});var j=[];e("div[class*="+h.options.prefix.replace(".","")+"]").not(h.options.exclude).each(function(){j.push(e(this))});var i=false;e(c).scroll(function(){i=true});setInterval(function(){if(i&&!h.scrolling){i=false;h.manualScroll(j)}},h.options.scrollRate);e(c).load(function(){if(h.isHash(c.location.hash)){var m=c.location.hash,k=e(h.options.context).find('a[href*="'+m+'"]');if(k.length>0){k.each(function(){var n=e(this);if(n.prop("hash")===m){n.trigger("click");return}})}else{var l=m.replace(/#/,h.options.prefix);if(e(l).length>0){h.scrolling=true;h.linkScroll(l,m)}}}else{h.manualScroll(j)}})}};e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))}})}})(jQuery,window,document);